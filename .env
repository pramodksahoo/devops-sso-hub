# =================================
# SSO Hub Environment Configuration
# =================================

# Database Configuration
POSTGRES_DB=sso_hub
POSTGRES_USER=sso_user
POSTGRES_PASSWORD=sso_secure_password_123
DATABASE_URL=postgresql://sso_user:sso_secure_password_123@postgres:5432/sso_hub

# Redis Configuration  
REDIS_URL=redis://redis:6379

# Keycloak Configuration
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin_secure_password_123
KC_DB=postgres
KC_DB_URL=jdbc:postgresql://postgres:5432/keycloak
KC_DB_USERNAME=keycloak_user
KC_DB_PASSWORD=keycloak_secure_password_123
KC_HOSTNAME=localhost
KC_HOSTNAME_PORT=8080
KC_HTTP_ENABLED=true
KC_PROXY=edge
KEYCLOAK_PUBLIC_URL=http://localhost:8080/realms/sso-hub

# NGINX OIDC Configuration
OIDC_CLIENT_ID=sso-hub-client
OIDC_CLIENT_SECRET=sso-client-secret
OIDC_DISCOVERY_URL=http://keycloak:8080/realms/sso-hub/.well-known/openid_configuration
OIDC_REDIRECT_URI=http://localhost:3002/auth/callback
OIDC_LOGOUT_PATH=/auth/logout
OIDC_SCOPE='openid email profile'

# Identity Header Signing
IDENTITY_HEADER_SECRET=8f4e7d9c2b1a6f8e5d3c9b7a4e6f8d2c1b9a7e5d3c8f6e4d2b9a7c5e3d8f6a4b

# Infisical Configuration
INFISICAL_URL=http://infisical:8080
INFISICAL_MACHINE_IDENTITY_CLIENT_ID=your_infisical_client_id
INFISICAL_MACHINE_IDENTITY_CLIENT_SECRET=your_infisical_client_secret

# Application URLs
# Application URLs (automatically updated by setup scripts)
FRONTEND_URL=http://localhost:3000
BACKEND_ECHO_URL=http://echo:3001

# Security Configuration
SESSION_SECRET=f7e8d9c2b1a6f8e5d3c9b7a4e6f8d2c1b9a7e5d3c8f6e4d2b9a7c5e3d8f6a4b2
CORS_ORIGIN=http://localhost:3000

# Logging
LOG_LEVEL=info

# External Access Configuration (set by configure-external-access.sh)
# Users can manually configure these before running setup.sh
# Or run ./configure-external-access.sh for interactive configuration
EXTERNAL_HOST=localhost
EXTERNAL_PROTOCOL=http
EXTERNAL_PORT=

# Infisical Configuration
INFISICAL_URL=http://infisical:8080
INFISICAL_MACHINE_IDENTITY_CLIENT_ID=your_infisical_client_id
INFISICAL_MACHINE_IDENTITY_CLIENT_SECRET=your_infisical_client_secret


# Admin Configuration Service
ADMIN_CONFIG_JWT_SECRET=admin-config-jwt-secret-key-change-in-production
ADMIN_API_KEY=admin-api-key-change-in-production
KEYCLOAK_REALM=sso-hub
KEYCLOAK_ADMIN_USERNAME=admin
KEYCLOAK_ADMIN_PASSWORD=admin_secure_password_123


# Service Ports (for development)
Blank_ideal_PORT=3001
AUTH_BFF_PORT=3002
USER_SERVICE_PORT=3003
TOOLS_SERVICE_PORT=3004
ADMIN_CONFIG_PORT=3005
CATALOG_PORT=3006
WEBHOOK_INGRESS_PORT=3007
Avalable_to_Use=3008
AUDIT_PORT=3009
ANALYTICS_PORT=3010
PROVISIONING_PORT=3011
LDAP_SYNC_PORT=3012
POLICY_PORT=3013
NOTIFIER_PORT=3014

# =================================
# Tool Integration Configuration
# =================================

# Tool Redirect URIs for OIDC/OAuth2 Authentication
GITHUB_REDIRECT_URI=http://localhost:3000/auth/github/callback
GITLAB_REDIRECT_URI=http://localhost:8080/-/users/auth/openid_connect/callback
JENKINS_REDIRECT_URI=http://localhost:8080/securityRealm/finishLogin
ARGOCD_REDIRECT_URI=http://localhost:8080/auth/callback
TERRAFORM_REDIRECT_URI=https://app.terraform.io/auth/callback
SONARQUBE_REDIRECT_URI=http://localhost:9000/oauth2/callback/oidc
GRAFANA_REDIRECT_URI=http://localhost:3100/login/generic_oauth
PROMETHEUS_REDIRECT_URI=http://localhost:9090/auth/callback
KIBANA_REDIRECT_URI=http://localhost:5601/api/security/oidc/callback
SNYK_REDIRECT_URI=https://app.snyk.io/auth/callback
JIRA_REDIRECT_URI=https://your-company.atlassian.net/login/saml/callback
SERVICENOW_REDIRECT_URI=https://your-instance.service-now.com/auth_redirect.do

# GitHub Integration (OAuth App + OIDC)
GITHUB_CLIENT_ID=github-client-oauth2
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_WEBHOOK_SECRET=your_github_webhook_secret
GITHUB_APP_ID=your_github_app_id
GITHUB_PRIVATE_KEY_PATH=/secrets/github-private-key.pem
GITHUB_ORGANIZATION=your_github_org

# GitLab Integration (OIDC)
GITLAB_CLIENT_ID=gitlab-client-oidc
GITLAB_CLIENT_SECRET=your_gitlab_client_secret
GITLAB_INSTANCE_URL=https://gitlab.com
GITLAB_WEBHOOK_SECRET=your_gitlab_webhook_secret
GITLAB_GROUP_ID=your_gitlab_group_id

# Jenkins Integration (OIDC Plugin)
JENKINS_URL=http://jenkins:8080
JENKINS_OIDC_CLIENT_ID=jenkins-client-oidc
JENKINS_OIDC_CLIENT_SECRET=jenkins-client-secret
JENKINS_ADMIN_TOKEN=your_jenkins_admin_token
JENKINS_WEBHOOK_SECRET=your_jenkins_webhook_secret

# Argo CD Integration (OIDC)
ARGOCD_URL=http://argocd:8080
ARGOCD_OIDC_CLIENT_ID=argocd-client
ARGOCD_OIDC_CLIENT_SECRET=argocd-client-oidc
ARGOCD_ADMIN_PASSWORD=your_argocd_admin_password
ARGOCD_WEBHOOK_SECRET=your_argocd_webhook_secret

# Terraform Cloud/Enterprise Integration (SAML/OIDC)
TERRAFORM_ORGANIZATION=terraform-client-oidc
TERRAFORM_TOKEN=your_terraform_token
TERRAFORM_SAML_ENTITY_ID=your_terraform_saml_entity_id
TERRAFORM_OIDC_CLIENT_ID=terraform-client
TERRAFORM_OIDC_CLIENT_SECRET=terraform-client-secret

# SonarQube Integration (OIDC) - Testing
SONARQUBE_URL=http://sonarqube:9000
SONARQUBE_OIDC_CLIENT_ID=sonarqube-client-oidc
SONARQUBE_OIDC_CLIENT_SECRET=sonarqube-client-secret
SONARQUBE_ADMIN_TOKEN=your_sonarqube_admin_token
SONARQUBE_WEBHOOK_SECRET=your_sonarqube_webhook_secret

# Grafana Integration (Generic OAuth OIDC) - Testing
GRAFANA_URL=http://localhost:3100
GRAFANA_OIDC_CLIENT_ID=grafana-client-oauth2
GRAFANA_OIDC_CLIENT_SECRET=grafana-client-secret
GRAFANA_ADMIN_PASSWORD=grafana_admin_pass
GRAFANA_WEBHOOK_SECRET=your_grafana_webhook_secret

# Prometheus Integration (Proxy-based auth)
PROMETHEUS_URL=http://prometheus:9090
PROMETHEUS_CONFIG_PATH=/etc/prometheus/prometheus.yml
PROMETHEUS_WEBHOOK_SECRET=your_prometheus_webhook_secret
PROMETHEUS_OIDC_CLIENT_ID=prometheus-client-oidc

# Kibana/Elastic Integration (SAML/OIDC)
KIBANA_URL=http://kibana:5601
ELASTICSEARCH_URL=http://elasticsearch:9200
KIBANA_OIDC_CLIENT_ID=kibana-client-oidc
KIBANA_OIDC_CLIENT_SECRET=kibana-client-secret
ELASTIC_PASSWORD=your_elastic_password
KIBANA_WEBHOOK_SECRET=your_kibana_webhook_secret

# Snyk Integration (OIDC)
SNYK_API_TOKEN=snyk-client-oidc
SNYK_ORG_ID=your_snyk_org_id
SNYK_OIDC_CLIENT_ID=snyk-client
SNYK_OIDC_CLIENT_SECRET=snyk-client-secret
SNYK_WEBHOOK_SECRET=your_snyk_webhook_secret

# Jira Integration (SAML/OIDC)
JIRA_URL=https://your-domain.atlassian.net
JIRA_CLIENT_ID=jira-client-saml
JIRA_CLIENT_SECRET=your_jira_client_secret
JIRA_WEBHOOK_SECRET=your_jira_webhook_secret
JIRA_PROJECT_KEY=your_jira_project_key

# ServiceNow Integration (SAML/OIDC)
SERVICENOW_INSTANCE_URL=https://your-instance.service-now.com
SERVICENOW_CLIENT_ID=servicenow-client-saml
SERVICENOW_CLIENT_SECRET=your_servicenow_client_secret
SERVICENOW_USERNAME=your_servicenow_username
SERVICENOW_PASSWORD=your_servicenow_password
SERVICENOW_WEBHOOK_SECRET=your_servicenow_webhook_secret

# =================================
# Webhook Configuration
# =================================

# General webhook settings
WEBHOOK_TIMEOUT=30000
WEBHOOK_RETRY_ATTEMPTS=3
WEBHOOK_RETRY_DELAY=5000

# Signature verification
WEBHOOK_SIGNATURE_ALGORITHM=sha256
WEBHOOK_SIGNATURE_HEADER=X-Hub-Signature-256

# =================================
# Tool Health Monitoring
# =================================

# Health check intervals (milliseconds)
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=10000
HEALTH_CHECK_RETRIES=3

# Discovery settings
TOOL_DISCOVERY_ENABLED=true
TOOL_DISCOVERY_INTERVAL=300000

# =================================
# Rate Limiting & Security
# =================================

# API rate limiting
API_RATE_LIMIT_WINDOW=60000
API_RATE_LIMIT_MAX_REQUESTS=100
API_RATE_LIMIT_SKIP_SUCCESSFUL=false

# Authentication rate limiting
AUTH_RATE_LIMIT_WINDOW=300000
AUTH_RATE_LIMIT_MAX_ATTEMPTS=5

# Webhook rate limiting
WEBHOOK_RATE_LIMIT_WINDOW=60000
WEBHOOK_RATE_LIMIT_MAX_REQUESTS=50

# =================================
# Audit & Analytics
# =================================

# Audit logging
AUDIT_LOG_LEVEL=info
AUDIT_RETENTION_DAYS=90
AUDIT_EXPORT_ENABLED=true

# Analytics collection
ANALYTICS_ENABLED=true
ANALYTICS_RETENTION_DAYS=365
ANALYTICS_ANONYMIZE_IPS=true

# =================================
# Infisical Integration (Enhanced)
# =================================

INFISICAL_ENCRYPTION_KEY=your-encryption-key-here-32-chars-minimum
INFISICAL_AUTH_SECRET=your-auth-secret-here-minimum-32-chars
INFISICAL_SITE_URL=http://infisical:8080
